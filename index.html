<!DOCTYPE html>
<html>

<head>
    <link href="https://fonts.googleapis.com/css?family=Inter&display=swap" rel="stylesheet" />
    <link href="/css/main.css" rel="stylesheet" />
    <title>Bio Page</title>
</head>

<body>

    <div class="container">
        <div class="header-section">
            <div class="album-art"></div>
            <div class="info-bar">
                <span class="artist-name">conical</span>
                <div class="owner-tag">
                    <span class="owner-text">Owner</span>
                </div>
            </div>
        </div>

        <div class="player-section">
            <span class="track-title">NYAN CAT THEME</span>
            <div class="controls">
                <audio id="audioPlayer">
                    <source src="/conical/music/music.mp3" type="audio/mpeg">
                    Ваш браузер не поддерживает элемент audio.
                </audio>

                <div class="play-pause-button" id="playPauseButton">
                    <div class="play-pause-bar bar-left"></div>
                    <div class="play-pause-bar bar-right"></div>
                </div>
                <div class="progress-bar-container" id="progressBarContainer">
                    <div class="progress-bar" id="progressBar"></div>
                    <div class="progress-thumb" id="progressThumb"></div>
                </div>
                <span class="time-display" id="timeDisplay">0:00</span>
            </div>
        </div>

    </div>

    <script>
        const audioPlayer = document.getElementById('audioPlayer');
        const playPauseButton = document.getElementById('playPauseButton');
        const progressBarContainer = document.getElementById('progressBarContainer');
        const progressBar = document.getElementById('progressBar');
        const progressThumb = document.getElementById('progressThumb');
        const timeDisplay = document.getElementById('timeDisplay');

        // Функция для обновления иконки Play/Pause
        function updatePlayPauseIcon() {
            if (audioPlayer.paused) {
                // Если пауза, показываем иконку Play (две вертикальные линии)
                playPauseButton.innerHTML = `
                    <div class="play-pause-bar bar-left"></div>
                    <div class="play-pause-bar bar-right"></div>
                `;
            } else {
                // Если играет, показываем иконку Pause (одна вертикальная линия)
                playPauseButton.innerHTML = `
                    <div class="play-pause-bar bar-left"></div>
                `;
            }
        }

        // Обработчик клика по кнопке Play/Pause
        playPauseButton.addEventListener('click', () => {
            if (audioPlayer.paused) {
                audioPlayer.play();
            } else {
                audioPlayer.pause();
            }
            updatePlayPauseIcon(); // Обновляем иконку после действия
        });

        // Обновление прогресс-бара и времени по мере воспроизведения
        audioPlayer.addEventListener('timeupdate', () => {
            const currentTime = audioPlayer.currentTime;
            const duration = audioPlayer.duration;

            // Обновление времени
            if (!isNaN(duration)) { // Проверяем, что длительность доступна
                const minutes = Math.floor(currentTime / 60);
                const seconds = Math.floor(currentTime % 60);
                timeDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

                // Обновление ширины прогресс-бара
                const progressPercent = (currentTime / duration) * 100;
                progressBar.style.width = `${progressPercent}%`;

                // Обновление положения ползунка
                progressThumb.style.left = `${progressPercent}%`;
            }
        });

        // Перемотка по клику на прогресс-баре
        progressBarContainer.addEventListener('click', (e) => {
            const rect = progressBarContainer.getBoundingClientRect();
            const clickX = e.clientX - rect.left; // X-координата клика относительно элемента
            const width = rect.width; // Ширина элемента
            const duration = audioPlayer.duration;

            if (!isNaN(duration)) {
                audioPlayer.currentTime = (clickX / width) * duration;
            }
        });

        // Когда музыка закончилась
        audioPlayer.addEventListener('ended', () => {
            audioPlayer.currentTime = 0; // Сброс на начало
            updatePlayPauseIcon(); // Сброс иконки на "плей"
            progressBar.style.width = '0%'; // Сброс прогресса
            progressThumb.style.left = '0%'; // Сброс ползунка
            timeDisplay.textContent = '0:00'; // Сброс времени
        });

        // Инициализация времени при загрузке метаданных
        audioPlayer.addEventListener('loadedmetadata', () => {
            const duration = audioPlayer.duration;
            if (!isNaN(duration)) {
                const minutes = Math.floor(duration / 60);
                const seconds = Math.floor(duration % 60);
                timeDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            }
            updatePlayPauseIcon(); // Установить начальную иконку (Play)
        });
    </script>
</body>

</html>